# bkit Command: pdca-iterate
# Platform: Gemini CLI
# Converted from: commands/pdca-iterate.md

description = "Run automatic Evaluator-Optimizer iteration cycle (반복 개선 / イテレーション / 迭代优化)"

prompt = """
# PDCA Iteration Execution

Receives feature name and options via $ARGUMENTS.

## Basic Usage

```bash
/pdca-iterate {feature}                    # Run full iteration cycle
/pdca-iterate {feature} --evaluator gap    # Gap analysis only
/pdca-iterate {feature} --max-iterations 7 # Custom iteration limit
/pdca-iterate {feature} --threshold 95     # Custom pass threshold
```

## Tasks Performed

### 1. Initial Assessment

1. Load design document: docs/02-design/features/{feature}.design.md
2. Identify implementation paths: src/features/{feature}/, api/{feature}/
3. Determine applicable evaluators based on content
4. Set iteration parameters (max iterations, thresholds)

### 2. Evaluation Phase

For each evaluator:
1. Run analysis (gap-detector, code-analyzer, qa-monitor)
2. Calculate score against criteria
3. Identify issues with severity levels
4. Generate improvement suggestions

### 3. Improvement Phase

If evaluation fails:
1. Sort issues by priority (Critical > Warning > Info)
2. Select top N issues for this iteration
3. Apply fixes using Edit/Write tools
4. Record changes made

### 4. Re-evaluation Phase

1. Re-run evaluators on modified code
2. Compare new scores with previous
3. Determine if criteria met or improvement made
4. Decide: continue, succeed, or fail

### 5. Report Generation

1. Create iteration report: docs/03-analysis/{feature}.iteration-report.md
2. Include score progression, changes made, final status
3. Provide next step recommendations

## Command Options

| Option | Description | Default |
|--------|-------------|---------|
| `--evaluator` | Specific evaluator (gap/quality/functional/all) | all |
| `--max-iterations` | Maximum iteration count | 5 |
| `--threshold` | Pass threshold percentage | 90 |
| `--fix-limit` | Max issues to fix per iteration | 5 |
| `--dry-run` | Analyze only, no fixes applied | false |

## Integration with PDCA

```
/pdca-plan login      → Plan document created
/pdca-design login    → Design document created
... implementation ...
/pdca-iterate login   → Auto-fix issues ← THIS COMMAND
/pdca-analyze login   → Final verification
/pdca-report login    → Completion report
```

## Cautions

- Default max: 5 iterations
- Always specify feature name
- Auto-fixes may introduce new issues
- Always review changes before committing
- Use --dry-run first for large changes
- Cannot iterate without design document
"""
